Function encircledenergySirianni, filter, radius, diff=diff
  radii = findgen(20)+1
  radii = [radii, findgen(16)*5+25]
  radii = [radii, 110]
  
  filters = ['F435W','F475W','F555W','F606W','F625W','F775W','F814W','F850LP','F892N']

  table = $
     [[0.289, 0.318, 0.311, 0.313, 0.312, 0.296, 0.293, 0.246, 0.241], $ 
      [0.626, 0.669, 0.662, 0.656, 0.648, 0.623, 0.603, 0.538, 0.546], $ 
      [0.775, 0.801, 0.795, 0.796, 0.795, 0.780, 0.764, 0.689, 0.711], $ 
      [0.832, 0.850, 0.843, 0.845, 0.844, 0.840, 0.833, 0.779, 0.802], $ 
      [0.859, 0.876, 0.871, 0.871, 0.868, 0.863, 0.858, 0.815, 0.835], $ 
      [0.875, 0.890, 0.891, 0.890, 0.888, 0.882, 0.879, 0.837, 0.858], $ 
      [0.884, 0.900, 0.899, 0.900, 0.899, 0.899, 0.895, 0.858, 0.878], $ 
      [0.892, 0.907, 0.908, 0.908, 0.907, 0.909, 0.907, 0.877, 0.895], $ 
      [0.900, 0.914, 0.915, 0.914, 0.914, 0.914, 0.914, 0.889, 0.906], $ 
      [0.906, 0.920, 0.920, 0.920, 0.920, 0.921, 0.920, 0.897, 0.912], $ 
      [0.912, 0.925, 0.924, 0.925, 0.924, 0.926, 0.926, 0.905, 0.917], $ 
      [0.916, 0.930, 0.929, 0.929, 0.929, 0.931, 0.931, 0.912, 0.923], $ 
      [0.920, 0.934, 0.933, 0.933, 0.933, 0.935, 0.935, 0.918, 0.927], $ 
      [0.923, 0.937, 0.935, 0.938, 0.937, 0.939, 0.939, 0.923, 0.930], $ 
      [0.926, 0.940, 0.938, 0.941, 0.940, 0.942, 0.942, 0.927, 0.934], $ 
      [0.929, 0.943, 0.940, 0.944, 0.943, 0.945, 0.945, 0.932, 0.937], $ 
      [0.931, 0.945, 0.942, 0.946, 0.946, 0.948, 0.948, 0.936, 0.940], $ 
      [0.934, 0.948, 0.944, 0.948, 0.948, 0.950, 0.951, 0.940, 0.943], $ 
      [0.937, 0.950, 0.946, 0.950, 0.950, 0.953, 0.953, 0.943, 0.945], $ 
      [0.940, 0.952, 0.948, 0.952, 0.952, 0.955, 0.955, 0.946, 0.947], $ 
      [0.952, 0.968, 0.957, 0.960, 0.959, 0.962, 0.962, 0.958, 0.957], $ 
      [0.964, 0.974, 0.965, 0.967, 0.965, 0.967, 0.968, 0.965, 0.963], $ 
      [0.973, 0.983, 0.973, 0.974, 0.972, 0.972, 0.973, 0.970, 0.968], $ 
      [0.980, 0.989, 0.980, 0.981, 0.977, 0.977, 0.976, 0.974, 0.972], $ 
      [0.983, 0.994, 0.985, 0.987, 0.982, 0.980, 0.980, 0.978, 0.976], $ 
      [0.986, 0.997, 0.989, 0.991, 0.986, 0.985, 0.982, 0.982, 0.979], $ 
      [0.991, 0.998, 0.991, 0.994, 0.989, 0.988, 0.987, 0.985, 0.982], $ 
      [0.993, 1.000, 0.993, 0.995, 0.991, 0.990, 0.990, 0.988, 0.984], $ 
      [0.995, 1.001, 0.995, 0.996, 0.994, 0.993, 0.991, 0.991, 0.986], $ 
      [0.995, 1.001, 0.996, 0.997, 0.997, 0.995, 0.994, 0.994, 0.989], $ 
      [0.997, 1.003, 0.996, 0.999, 0.997, 0.995, 0.996, 0.996, 0.989], $ 
      [0.997, 1.002, 0.998, 0.998, 0.998, 0.998, 0.997, 0.997, 0.992], $ 
      [0.999, 1.002, 1.000, 0.999, 0.999, 0.999, 0.999, 0.997, 0.993], $ 
      [1.000, 1.002, 0.999, 1.000, 1.000, 1.000, 0.999, 1.000, 0.995], $ 
      [1.000, 1.001, 1.000, 1.000, 1.000, 1.000, 1.000, 1.001, 0.997], $ 
      [0.999, 1.001, 1.001, 1.001, 1.001, 1.001, 1.000, 1.001, 0.997], $ 
      [1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000]]
  ifilter=where(filter eq filters)
  EE = table[ifilter, *]
  if keyword_set(diff) then begin
     EE = EE-shift(EE,1)
     EE[0] = table[ifilter,0]
     rin = shift(radii, 1)
     rin[0] = 0.
     EE /= (radii*radii-rin*rin)*!pi
  endif
  return, interpol(EE, radii, radius)
end
